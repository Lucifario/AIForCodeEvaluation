{
  "project": "Time",
  "bug_id": 17,
  "buggy_compiled": true,
  "fixed_compiled": true,
  "buggy_metadata": {
    "classes.modified": [
      "org.joda.time.DateTimeZone"
    ],
    "tests.trigger": [
      "org.joda.time.TestDateTimeZoneCutover::testBug3476684_adjustOffset"
    ],
    "dir.src.classes": [
      "src/main/java"
    ]
  },
  "fixed_metadata": {
    "classes.modified": [
      "org.joda.time.DateTimeZone"
    ],
    "tests.trigger": [
      "org.joda.time.TestDateTimeZoneCutover::testBug3476684_adjustOffset"
    ],
    "dir.src.classes": [
      "src/main/java"
    ]
  },
  "diff": "diff --git a/data/defects4j_bugs/Time_17b/.defects4j.config b/data/defects4j_bugs/Time_17f/.defects4j.config\nindex a0a331b..07b269e 100644\n--- a/data/defects4j_bugs/Time_17b/.defects4j.config\n+++ b/data/defects4j_bugs/Time_17f/.defects4j.config\n@@ -1,3 +1,3 @@\n #File automatically generated by Defects4J\n pid=Time\n-vid=17b\n+vid=17f\ndiff --git a/data/defects4j_bugs/Time_17b/.git/HEAD b/data/defects4j_bugs/Time_17f/.git/HEAD\nindex b8fed09..a0edece 100644\n--- a/data/defects4j_bugs/Time_17b/.git/HEAD\n+++ b/data/defects4j_bugs/Time_17f/.git/HEAD\n@@ -1 +1 @@\n-f5a8d4467e8a13a7ee16003163bc56c595901402\n+ca79a5089584b3cf576aabfc8c8f89a6a11fb386\ndiff --git a/data/defects4j_bugs/Time_17b/.git/index b/data/defects4j_bugs/Time_17f/.git/index\nindex 4cf41e7..56b5c9e 100644\nBinary files a/data/defects4j_bugs/Time_17b/.git/index and b/data/defects4j_bugs/Time_17f/.git/index differ\ndiff --git a/data/defects4j_bugs/Time_17b/.git/logs/HEAD b/data/defects4j_bugs/Time_17f/.git/logs/HEAD\nindex d9f8b4d..dd91a9e 100644\n--- a/data/defects4j_bugs/Time_17b/.git/logs/HEAD\n+++ b/data/defects4j_bugs/Time_17f/.git/logs/HEAD\n@@ -1,9 +1,9 @@\n-0000000000000000000000000000000000000000 3c05be0bd6ea73a77bc782ac5acff937c53a6416 Aayush Kumar <lucifario@Aayushs-MacBook-Pro.local> 1761426445 -0700\tclone: from /Users/lucifario/Documents/Code/AIForCodeReview/defects4j/project_repos/joda-time.git\n-3c05be0bd6ea73a77bc782ac5acff937c53a6416 a8913f5ad5dfde59263c981c9e9eb28e43fd2e00 Aayush Kumar <lucifario@Aayushs-MacBook-Pro.local> 1761426445 -0700\tcheckout: moving from main to a8913f5ad5dfde59263c981c9e9eb28e43fd2e00\n-a8913f5ad5dfde59263c981c9e9eb28e43fd2e00 8a13d6b48fe179ebc6f78bf0618fd88054883d7f defects4j <defects4j@localhost> 1761426446 -0700\tcommit: D4J_Time_17_POST_FIX_REVISION\n-8a13d6b48fe179ebc6f78bf0618fd88054883d7f 5618bd644d307b97aae60446a17335013e253aad defects4j <defects4j@localhost> 1761426446 -0700\tcommit: D4J_Time_17_POST_FIX_COMPILABLE\n-5618bd644d307b97aae60446a17335013e253aad fc9907cf5ea4fffcba19359ab2a3446f5645e7bd defects4j <defects4j@localhost> 1761426449 -0700\tcommit: D4J_Time_17_FIXED_VERSION\n-fc9907cf5ea4fffcba19359ab2a3446f5645e7bd f5a8d4467e8a13a7ee16003163bc56c595901402 defects4j <defects4j@localhost> 1761426449 -0700\tcommit: D4J_Time_17_BUGGY_VERSION\n-f5a8d4467e8a13a7ee16003163bc56c595901402 8a13d6b48fe179ebc6f78bf0618fd88054883d7f defects4j <defects4j@localhost> 1761426449 -0700\tcheckout: moving from f5a8d4467e8a13a7ee16003163bc56c595901402 to D4J_Time_17_POST_FIX_REVISION\n-8a13d6b48fe179ebc6f78bf0618fd88054883d7f 6953a36cb6bce8c7b63c6b29037223cedd11181a defects4j <defects4j@localhost> 1761426449 -0700\tcommit: D4J_Time_17_PRE_FIX_REVISION\n-6953a36cb6bce8c7b63c6b29037223cedd11181a f5a8d4467e8a13a7ee16003163bc56c595901402 defects4j <defects4j@localhost> 1761426449 -0700\tcheckout: moving from 6953a36cb6bce8c7b63c6b29037223cedd11181a to D4J_Time_17_BUGGY_VERSION\n+0000000000000000000000000000000000000000 3c05be0bd6ea73a77bc782ac5acff937c53a6416 Aayush Kumar <lucifario@Aayushs-MacBook-Pro.local> 1761426449 -0700\tclone: from /Users/lucifario/Documents/Code/AIForCodeReview/defects4j/project_repos/joda-time.git\n+3c05be0bd6ea73a77bc782ac5acff937c53a6416 a8913f5ad5dfde59263c981c9e9eb28e43fd2e00 Aayush Kumar <lucifario@Aayushs-MacBook-Pro.local> 1761426449 -0700\tcheckout: moving from main to a8913f5ad5dfde59263c981c9e9eb28e43fd2e00\n+a8913f5ad5dfde59263c981c9e9eb28e43fd2e00 1876b63e6227ee4a5578ca19762fe374795c19f3 defects4j <defects4j@localhost> 1761426449 -0700\tcommit: D4J_Time_17_POST_FIX_REVISION\n+1876b63e6227ee4a5578ca19762fe374795c19f3 b4933ee10588db323aa22db0ef5b442c284e88d0 defects4j <defects4j@localhost> 1761426449 -0700\tcommit: D4J_Time_17_POST_FIX_COMPILABLE\n+b4933ee10588db323aa22db0ef5b442c284e88d0 ca79a5089584b3cf576aabfc8c8f89a6a11fb386 defects4j <defects4j@localhost> 1761426453 -0700\tcommit: D4J_Time_17_FIXED_VERSION\n+ca79a5089584b3cf576aabfc8c8f89a6a11fb386 0a9c451937a70f9a0f566bffe8f229572a163d90 defects4j <defects4j@localhost> 1761426453 -0700\tcommit: D4J_Time_17_BUGGY_VERSION\n+0a9c451937a70f9a0f566bffe8f229572a163d90 1876b63e6227ee4a5578ca19762fe374795c19f3 defects4j <defects4j@localhost> 1761426453 -0700\tcheckout: moving from 0a9c451937a70f9a0f566bffe8f229572a163d90 to D4J_Time_17_POST_FIX_REVISION\n+1876b63e6227ee4a5578ca19762fe374795c19f3 80d1d9c346ec17749a58ce4839a8da1f231dc8cc defects4j <defects4j@localhost> 1761426453 -0700\tcommit: D4J_Time_17_PRE_FIX_REVISION\n+80d1d9c346ec17749a58ce4839a8da1f231dc8cc ca79a5089584b3cf576aabfc8c8f89a6a11fb386 defects4j <defects4j@localhost> 1761426453 -0700\tcheckout: moving from 80d1d9c346ec17749a58ce4839a8da1f231dc8cc to D4J_Time_17_FIXED_VERSION\ndiff --git a/data/defects4j_bugs/Time_17b/.git/logs/refs/heads/main b/data/defects4j_bugs/Time_17f/.git/logs/refs/heads/main\nindex 470fcbd..9ec8ffa 100644\n--- a/data/defects4j_bugs/Time_17b/.git/logs/refs/heads/main\n+++ b/data/defects4j_bugs/Time_17f/.git/logs/refs/heads/main\n@@ -1 +1 @@\n-0000000000000000000000000000000000000000 3c05be0bd6ea73a77bc782ac5acff937c53a6416 Aayush Kumar <lucifario@Aayushs-MacBook-Pro.local> 1761426445 -0700\tclone: from /Users/lucifario/Documents/Code/AIForCodeReview/defects4j/project_repos/joda-time.git\n+0000000000000000000000000000000000000000 3c05be0bd6ea73a77bc782ac5acff937c53a6416 Aayush Kumar <lucifario@Aayushs-MacBook-Pro.local> 1761426449 -0700\tclone: from /Users/lucifario/Documents/Code/AIForCodeReview/defects4j/project_repos/joda-time.git\ndiff --git a/data/defects4j_bugs/Time_17b/.git/logs/refs/remotes/origin/HEAD b/data/defects4j_bugs/Time_17f/.git/logs/refs/remotes/origin/HEAD\nindex 470fcbd..9ec8ffa 100644\n--- a/data/defects4j_bugs/Time_17b/.git/logs/refs/remotes/origin/HEAD\n+++ b/data/defects4j_bugs/Time_17f/.git/logs/refs/remotes/origin/HEAD\n@@ -1 +1 @@\n-0000000000000000000000000000000000000000 3c05be0bd6ea73a77bc782ac5acff937c53a6416 Aayush Kumar <lucifario@Aayushs-MacBook-Pro.local> 1761426445 -0700\tclone: from /Users/lucifario/Documents/Code/AIForCodeReview/defects4j/project_repos/joda-time.git\n+0000000000000000000000000000000000000000 3c05be0bd6ea73a77bc782ac5acff937c53a6416 Aayush Kumar <lucifario@Aayushs-MacBook-Pro.local> 1761426449 -0700\tclone: from /Users/lucifario/Documents/Code/AIForCodeReview/defects4j/project_repos/joda-time.git\ndiff --git a/data/defects4j_bugs/Time_17f/.git/objects/0a/9c451937a70f9a0f566bffe8f229572a163d90 b/data/defects4j_bugs/Time_17f/.git/objects/0a/9c451937a70f9a0f566bffe8f229572a163d90\nnew file mode 100644\nindex 0000000..0f6c18b\n--- /dev/null\n+++ b/data/defects4j_bugs/Time_17f/.git/objects/0a/9c451937a70f9a0f566bffe8f229572a163d90\n@@ -0,0 +1 @@\n+x\u0001j\u00021\u0010qyL\u0012RDBeveM\u07ff\u0403\u000fw8\"/lKg*z\u0002\u0016\u001402!\u0012\u000b\u0010\u001a o\u06bcJ*B!\u00178DXd5\\\u0005\u000e1vf\u007fjnx{>^&q\u0007\u000f\u0001;F~\u0019R\bN\u0006\n>\u001fzHs_\u06f7\u0017\u000bI\n\\ No newline at end of file\ndiff --git a/data/defects4j_bugs/Time_17f/.git/objects/18/76b63e6227ee4a5578ca19762fe374795c19f3 b/data/defects4j_bugs/Time_17f/.git/objects/18/76b63e6227ee4a5578ca19762fe374795c19f3\nnew file mode 100644\nindex 0000000..26d3894\n--- /dev/null\n+++ b/data/defects4j_bugs/Time_17f/.git/objects/18/76b63e6227ee4a5578ca19762fe374795c19f3\n@@ -0,0 +1,4 @@\n+x\u0001A\n+0\u0010@Q=E. 4$M@\u0105\n+u\"t2A+.<y[\u0016\n+I\u001en\f)ZV\u0013Kth0\u0182l\u0101\u001fYR'\u0014xe5y'\u0273F9\u0006, \"'<]~h{\u068fy.de%(\u000b\u0174>\u00126t8*wSX\u05d7pXc\u0016o[K\n\\ No newline at end of file\ndiff --git a/data/defects4j_bugs/Time_17b/.git/objects/56/18bd644d307b97aae60446a17335013e253aad b/data/defects4j_bugs/Time_17b/.git/objects/56/18bd644d307b97aae60446a17335013e253aad\ndeleted file mode 100644\nindex 2e1fb81..0000000\nBinary files a/data/defects4j_bugs/Time_17b/.git/objects/56/18bd644d307b97aae60446a17335013e253aad and /dev/null differ\ndiff --git a/data/defects4j_bugs/Time_17b/.git/objects/69/53a36cb6bce8c7b63c6b29037223cedd11181a b/data/defects4j_bugs/Time_17b/.git/objects/69/53a36cb6bce8c7b63c6b29037223cedd11181a\ndeleted file mode 100644\nindex 5df3340..0000000\n--- a/data/defects4j_bugs/Time_17b/.git/objects/69/53a36cb6bce8c7b63c6b29037223cedd11181a\n+++ /dev/null\n@@ -1 +0,0 @@\n-x\u0001j\u00021\u0010@=+\u0003Bfwv2\u0001\u001eja{bK-d'\u0013TnYW<\u0001=Lxi\u00e2\u03aa\u0585\u000eX\u0004\u06e2\u0002D2cH\u021c!$\b\u001dQj_ZNf\u001a\u000f:\b\u0015Cq\u0004\\2nZ}1\u001efe\u0005Ov$|.um\u0013`C.w}\u0013yu\u001c5&?q?\ud1f9\u0002l_J\n\\ No newline at end of file\ndiff --git a/data/defects4j_bugs/Time_17f/.git/objects/80/d1d9c346ec17749a58ce4839a8da1f231dc8cc b/data/defects4j_bugs/Time_17f/.git/objects/80/d1d9c346ec17749a58ce4839a8da1f231dc8cc\nnew file mode 100644\nindex 0000000..c3fec53\nBinary files /dev/null and b/data/defects4j_bugs/Time_17f/.git/objects/80/d1d9c346ec17749a58ce4839a8da1f231dc8cc differ\ndiff --git a/data/defects4j_bugs/Time_17b/.git/objects/8a/13d6b48fe179ebc6f78bf0618fd88054883d7f b/data/defects4j_bugs/Time_17b/.git/objects/8a/13d6b48fe179ebc6f78bf0618fd88054883d7f\ndeleted file mode 100644\nindex 3c03e92..0000000\n--- a/data/defects4j_bugs/Time_17b/.git/objects/8a/13d6b48fe179ebc6f78bf0618fd88054883d7f\n+++ /dev/null\n@@ -1 +0,0 @@\n-x\u00010\u0010a}$i\u0002\"{XzPQ\u0011oa:n6+{\u0007_>y\u001cGQ\u0006ED\u001c\u001bO\u000eQ\u000e,<:\u001b2u3e!\u0006o(A(`r\u0004\u00179\u0019~}T,\\fx\u007f~#S\u007f\u001fVA\n\u0006\u0001P-o\u001b]<\u0006\u0012-6\u001e/ZDK\n\\ No newline at end of file\ndiff --git a/data/defects4j_bugs/Time_17f/.git/objects/b4/933ee10588db323aa22db0ef5b442c284e88d0 b/data/defects4j_bugs/Time_17f/.git/objects/b4/933ee10588db323aa22db0ef5b442c284e88d0\nnew file mode 100644\nindex 0000000..fb38584\nBinary files /dev/null and b/data/defects4j_bugs/Time_17f/.git/objects/b4/933ee10588db323aa22db0ef5b442c284e88d0 differ\ndiff --git a/data/defects4j_bugs/Time_17f/.git/objects/ca/79a5089584b3cf576aabfc8c8f89a6a11fb386 b/data/defects4j_bugs/Time_17f/.git/objects/ca/79a5089584b3cf576aabfc8c8f89a6a11fb386\nnew file mode 100644\nindex 0000000..1afec26\nBinary files /dev/null and b/data/defects4j_bugs/Time_17f/.git/objects/ca/79a5089584b3cf576aabfc8c8f89a6a11fb386 differ\ndiff --git a/data/defects4j_bugs/Time_17b/.git/objects/f5/a8d4467e8a13a7ee16003163bc56c595901402 b/data/defects4j_bugs/Time_17b/.git/objects/f5/a8d4467e8a13a7ee16003163bc56c595901402\ndeleted file mode 100644\nindex 406588e..0000000\nBinary files a/data/defects4j_bugs/Time_17b/.git/objects/f5/a8d4467e8a13a7ee16003163bc56c595901402 and /dev/null differ\ndiff --git a/data/defects4j_bugs/Time_17b/.git/objects/fc/9907cf5ea4fffcba19359ab2a3446f5645e7bd b/data/defects4j_bugs/Time_17b/.git/objects/fc/9907cf5ea4fffcba19359ab2a3446f5645e7bd\ndeleted file mode 100644\nindex f6ded4d..0000000\nBinary files a/data/defects4j_bugs/Time_17b/.git/objects/fc/9907cf5ea4fffcba19359ab2a3446f5645e7bd and /dev/null differ\ndiff --git a/data/defects4j_bugs/Time_17b/.git/refs/tags/D4J_Time_17_BUGGY_VERSION b/data/defects4j_bugs/Time_17f/.git/refs/tags/D4J_Time_17_BUGGY_VERSION\nindex b8fed09..f98c64f 100644\n--- a/data/defects4j_bugs/Time_17b/.git/refs/tags/D4J_Time_17_BUGGY_VERSION\n+++ b/data/defects4j_bugs/Time_17f/.git/refs/tags/D4J_Time_17_BUGGY_VERSION\n@@ -1 +1 @@\n-f5a8d4467e8a13a7ee16003163bc56c595901402\n+0a9c451937a70f9a0f566bffe8f229572a163d90\ndiff --git a/data/defects4j_bugs/Time_17b/.git/refs/tags/D4J_Time_17_FIXED_VERSION b/data/defects4j_bugs/Time_17f/.git/refs/tags/D4J_Time_17_FIXED_VERSION\nindex b428ab2..a0edece 100644\n--- a/data/defects4j_bugs/Time_17b/.git/refs/tags/D4J_Time_17_FIXED_VERSION\n+++ b/data/defects4j_bugs/Time_17f/.git/refs/tags/D4J_Time_17_FIXED_VERSION\n@@ -1 +1 @@\n-fc9907cf5ea4fffcba19359ab2a3446f5645e7bd\n+ca79a5089584b3cf576aabfc8c8f89a6a11fb386\ndiff --git a/data/defects4j_bugs/Time_17b/.git/refs/tags/D4J_Time_17_POST_FIX_COMPILABLE b/data/defects4j_bugs/Time_17f/.git/refs/tags/D4J_Time_17_POST_FIX_COMPILABLE\nindex ea363de..3112828 100644\n--- a/data/defects4j_bugs/Time_17b/.git/refs/tags/D4J_Time_17_POST_FIX_COMPILABLE\n+++ b/data/defects4j_bugs/Time_17f/.git/refs/tags/D4J_Time_17_POST_FIX_COMPILABLE\n@@ -1 +1 @@\n-5618bd644d307b97aae60446a17335013e253aad\n+b4933ee10588db323aa22db0ef5b442c284e88d0\ndiff --git a/data/defects4j_bugs/Time_17b/.git/refs/tags/D4J_Time_17_POST_FIX_REVISION b/data/defects4j_bugs/Time_17f/.git/refs/tags/D4J_Time_17_POST_FIX_REVISION\nindex c6da353..b13f6c8 100644\n--- a/data/defects4j_bugs/Time_17b/.git/refs/tags/D4J_Time_17_POST_FIX_REVISION\n+++ b/data/defects4j_bugs/Time_17f/.git/refs/tags/D4J_Time_17_POST_FIX_REVISION\n@@ -1 +1 @@\n-8a13d6b48fe179ebc6f78bf0618fd88054883d7f\n+1876b63e6227ee4a5578ca19762fe374795c19f3\ndiff --git a/data/defects4j_bugs/Time_17b/.git/refs/tags/D4J_Time_17_PRE_FIX_REVISION b/data/defects4j_bugs/Time_17f/.git/refs/tags/D4J_Time_17_PRE_FIX_REVISION\nindex c923333..1179bc7 100644\n--- a/data/defects4j_bugs/Time_17b/.git/refs/tags/D4J_Time_17_PRE_FIX_REVISION\n+++ b/data/defects4j_bugs/Time_17f/.git/refs/tags/D4J_Time_17_PRE_FIX_REVISION\n@@ -1 +1 @@\n-6953a36cb6bce8c7b63c6b29037223cedd11181a\n+80d1d9c346ec17749a58ce4839a8da1f231dc8cc\ndiff --git a/data/defects4j_bugs/Time_17b/build/classes/org/joda/time/DateTimeZone$Stub.class b/data/defects4j_bugs/Time_17f/build/classes/org/joda/time/DateTimeZone$Stub.class\nindex d7fe9e3..b9b1c46 100644\nBinary files a/data/defects4j_bugs/Time_17b/build/classes/org/joda/time/DateTimeZone$Stub.class and b/data/defects4j_bugs/Time_17f/build/classes/org/joda/time/DateTimeZone$Stub.class differ\ndiff --git a/data/defects4j_bugs/Time_17b/build/classes/org/joda/time/DateTimeZone.class b/data/defects4j_bugs/Time_17f/build/classes/org/joda/time/DateTimeZone.class\nindex 951b9ca..b530759 100644\nBinary files a/data/defects4j_bugs/Time_17b/build/classes/org/joda/time/DateTimeZone.class and b/data/defects4j_bugs/Time_17f/build/classes/org/joda/time/DateTimeZone.class differ\ndiff --git a/data/defects4j_bugs/Time_17b/src/main/java/org/joda/time/DateTimeZone.java b/data/defects4j_bugs/Time_17f/src/main/java/org/joda/time/DateTimeZone.java\nindex 74a3802..7219899 100644\n--- a/data/defects4j_bugs/Time_17b/src/main/java/org/joda/time/DateTimeZone.java\n+++ b/data/defects4j_bugs/Time_17f/src/main/java/org/joda/time/DateTimeZone.java\n@@ -1164,19 +1164,32 @@ public abstract class DateTimeZone implements Serializable {\n         // a bit messy, but will work in all non-pathological cases\n         \n         // evaluate 3 hours before and after to work out if anything is happening\n-        long instantBefore = convertUTCToLocal(instant - 3 * DateTimeConstants.MILLIS_PER_HOUR);\n-        long instantAfter = convertUTCToLocal(instant + 3 * DateTimeConstants.MILLIS_PER_HOUR);\n-        if (instantBefore == instantAfter) {\n+        long instantBefore = instant - 3 * DateTimeConstants.MILLIS_PER_HOUR;\n+        long instantAfter = instant + 3 * DateTimeConstants.MILLIS_PER_HOUR;\n+        long offsetBefore = getOffset(instantBefore);\n+        long offsetAfter = getOffset(instantAfter);\n+        if (offsetBefore <= offsetAfter) {\n             return instant;  // not an overlap (less than is a gap, equal is normal case)\n         }\n         \n         // work out range of instants that have duplicate local times\n-        long local = convertUTCToLocal(instant);\n-        return convertLocalToUTC(local, false, earlierOrLater ? instantAfter : instantBefore);\n+        long diff = offsetBefore - offsetAfter;\n+        long transition = nextTransition(instantBefore);\n+        long overlapStart = transition - diff;\n+        long overlapEnd = transition + diff;\n+        if (instant < overlapStart || instant >= overlapEnd) {\n+          return instant;  // not an overlap\n+        }\n         \n         // calculate result\n+        long afterStart = instant - overlapStart;\n+        if (afterStart >= diff) {\n           // currently in later offset\n+          return earlierOrLater ? instant : instant - diff;\n+        } else {\n           // currently in earlier offset\n+          return earlierOrLater ? instant + diff : instant;\n+        }\n     }\n //    System.out.println(new DateTime(transitionStart, DateTimeZone.UTC) + \" \" + new DateTime(transitionStart, this));\n \n",
  "source_files_path": "data/defects4j_bugs/Time_17_source"
}