{"sample_id": "Chart_22", "model": "mistral-nemo", "code_context": "/* ===========================================================\n * JFreeChart : a free chart library for the Java(tm) platform\n * ===========================================================\n *\n * (C) Copyright 2000-2007, by Object Refinery Limited and Contributors.\n *\n * Project Info:  http://www.jfree.org/jfreechart/index.html\n *\n * This library is free software; you can redistribute it and/or modify it \n * under the terms of the GNU Lesser General Public License as published by \n * the Free Software Foundation; either version 2.1 of the License, or \n * (at your option) any later version.\n *\n * This library is distributed in the hope that it will be useful, but \n * WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY \n * or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public \n * License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public\n * License along with this library; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, \n * USA.  \n *\n * [Java is a trademark or registered trademark of Sun Microsystems, Inc. \n * in the United States and other countries.]\n *\n * ------------------\n * KeyedObject2D.java\n * ------------------\n * (C) Copyright 2003-2007, by Object Refinery Limited.\n *\n * Original Author:  David Gilbert (for Object Refinery Limited);\n * Contributor(s):   -;\n *\n * Changes\n * -------\n * 05-Feb-2003 : Version 1 (DG);\n * 01-Mar-2004 : Added equals() and clone() methods and implemented \n *               Serializable (DG);\n * 03-Oct-2007 : Updated getObject() to handle modified behaviour in \n *               KeyedObjects class (DG);\n *\n */\n\npackage org.jfree.data;\n\nimport java.io.Serializable;\nimport java.util.Collections;\nimport java.util.Iterator;\nimport java.util.List;\n\n\n/**\n * A data structure that stores zero, one or many objects, where each object is\n * associated with two keys (a 'row' key and a 'column' key).\n */\npublic class KeyedObjects2D implements Cloneable, Serializable {\n\n    /** For serialization. */\n    private static final long serialVersionUID = -1015873563138522374L;\n    \n    /** The row keys. */\n    private List rowKeys;\n\n    /** The column keys. */\n    private List columnKeys;\n\n    /** The row data. */\n    private List rows;\n\n    /**\n     * Creates a new instance (initially empty).\n     */\n    public KeyedObjects2D() {\n        this.rowKeys = new java.util.ArrayList();\n        this.columnKeys = new java.util.ArrayList();\n        this.rows = new java.util.ArrayList();\n    }\n\n    /**\n     * Returns the row count.\n     *\n     * @return The row count.\n     * \n     * @see #getColumnCount()\n     */\n    public int getRowCount() {\n        return this.rowKeys.size();\n    }\n\n    /**\n     * Returns the column count.\n     *\n     * @return The column count.\n     * \n     * @see #getRowCount()\n     */\n    public int getColumnCount() {\n        return this.columnKeys.size();\n    }\n\n    /**\n     * Returns the object for a given row and column.\n     *\n     * @param row  the row index (in the range 0 to getRowCount() - 1).\n     * @param column  the column index (in the range 0 to getColumnCount() - 1).\n     *\n     * @return The object (possibly <code>null</code>).\n     * \n     * @see #getObject(Comparable, Comparable)\n     */\n    public Object getObject(int row, int column) {\n        Object result = null;\n        KeyedObjects rowData = (KeyedObjects) this.rows.get(row);\n        if (rowData != null) {\n            Comparable columnKey = (Comparable) this.columnKeys.get(column);\n            if (columnKey != null) {\n                int index = rowData.getIndex(columnKey);\n                if (index >= 0) {\n                    result = rowData.getObject(columnKey);\n                }\n            }\n        }\n        return result;\n    }\n\n    /**\n     * Returns the key for a given row.\n     *\n     * @param row  the row index (zero based).\n     *\n     * @return The row index.\n     * \n     * @see #getRowIndex(Comparable)\n     */\n    public Comparable getRowKey(int row) {\n        return (Comparable) this.rowKeys.get(row);\n    }\n\n    /**\n     * Returns the row index for a given key.\n     *\n     * @param key  the key.\n     *\n     * @return The row index.\n     * \n     * @see #getRowKey(int)\n     */\n    public int getRowIndex(Comparable key) {\n        return this.rowKeys.indexOf(key);\n    }\n\n    /**\n     * Returns the row keys.\n     *\n     * @return The row keys (never <code>null</code>).\n     * \n     * @see #getRowKeys()\n     */\n    public List getRowKeys() {\n        return Collections.unmodifiableList(this.rowKeys);\n    }\n\n    /**\n     * Returns the key for a given column.\n     *\n     * @param column  the column.\n     *\n     * @return The key.\n     * \n     * @see #getColumnIndex(Comparable)\n     */\n    public Comparable getColumnKey(int column) {\n        return (Comparable) this.columnKeys.get(column);\n    }\n\n    /**\n     * Returns the column index for a given key.\n     *\n     * @param key  the key.\n     *\n     * @return The column index.\n     * \n     * @see #getColumnKey(int)\n     */\n    public int getColumnIndex(Comparable key) {\n        return this.columnKeys.indexOf(key);\n    }\n\n    /**\n     * Returns the column keys.\n     *\n     * @return The column keys (never <code>null</code>).\n     * \n     * @see #getRowKeys()\n     */\n    public List getColumnKeys() {\n        return Collections.unmodifiableList(this.columnKeys);\n    }\n\n    /**\n     * Returns the object for the given row and column keys.\n     *\n     * @param rowKey  the row key (<code>null</code> not permitted).\n     * @param columnKey  the column key (<code>null</code> not permitted).\n     *\n     * @return The object (possibly <code>null</code>).\n     * \n     * @throws IllegalArgumentException if <code>rowKey<code> or \n     *         <code>columnKey</code> is <code>null</code>.\n     * @throws UnknownKeyException if <code>rowKey</code> or \n     *         <code>columnKey</code> is not recognised.\n     */\n    public Object getObject(Comparable rowKey, Comparable columnKey) {\n        if (rowKey == null) {\n            throw new IllegalArgumentException(\"Null 'rowKey' argument.\");\n        }\n        if (columnKey == null) {\n            throw new IllegalArgumentException(\"Null 'columnKey' argument.\");\n        }\n        int row = this.rowKeys.indexOf(rowKey);\n        if (row < 0) {\n            throw new UnknownKeyException(\"Row key (\" + rowKey \n                    + \") not recognised.\");\n        }\n        int column = this.columnKeys.indexOf(columnKey);\n        if (column < 0) {\n            throw new UnknownKeyException(\"Column key (\" + columnKey \n                    + \") not recognised.\");\n        }\n        if (row >= 0) {\n        KeyedObjects rowData = (KeyedObjects) this.rows.get(row);\n            return rowData.getObject(columnKey);\n        }\n        else {\n            return null;\n        }\n    }\n\n    /**\n     * Adds an object to the table.  Performs the same function as setObject().\n     *\n     * @param object  the object.\n     * @param rowKey  the row key (<code>null</code> not permitted).\n     * @param columnKey  the column key (<code>null</code> not permitted).\n     */\n    public void addObject(Object object, Comparable rowKey, \n            Comparable columnKey) {\n        setObject(object, rowKey, columnKey);\n    }\n\n    /**\n     * Adds or updates an object.\n     *\n     * @param object  the object.\n     * @param rowKey  the row key (<code>null</code> not permitted).\n     * @param columnKey  the column key (<code>null</code> not permitted).\n     */\n    public void setObject(Object object, Comparable rowKey, \n            Comparable columnKey) {\n\n        if (rowKey == null) {\n            throw new IllegalArgumentException(\"Null 'rowKey' argument.\");\n        }\n        if (columnKey == null) {\n            throw new IllegalArgumentException(\"Null 'columnKey' argument.\");\n        }\n        KeyedObjects row;\n        int rowIndex = this.rowKeys.indexOf(rowKey);\n        if (rowIndex >= 0) {\n            row = (KeyedObjects) this.rows.get(rowIndex);\n        }\n        else {\n            this.rowKeys.add(rowKey);\n            row = new KeyedObjects();\n            this.rows.add(row);\n        }\n        row.setObject(columnKey, object);\n        int columnIndex = this.columnKeys.indexOf(columnKey);\n        if (columnIndex < 0) {\n            this.columnKeys.add(columnKey);\n        }\n\n    }\n\n    /**\n     * Removes an object from the table by setting it to <code>null</code>.  If\n     * all the objects in the specified row and/or column are now \n     * <code>null</code>, the row and/or column is removed from the table.\n     *\n     * @param rowKey  the row key (<code>null</code> not permitted).\n     * @param columnKey  the column key (<code>null</code> not permitted).\n     * \n     * @see #addObject(Object, Comparable, Comparable)\n     */\n    public void removeObject(Comparable rowKey, Comparable columnKey) {\n        setObject(null, rowKey, columnKey);\n        \n        // 1. check whether the row is now empty.\n        boolean allNull = true;\n        int rowIndex = getRowIndex(rowKey);\n        KeyedObjects row = (KeyedObjects) this.rows.get(rowIndex);\n\n        for (int item = 0, itemCount = row.getItemCount(); item < itemCount; \n             item++) {\n            if (row.getObject(item) != null) {\n                allNull = false;\n                break;\n            }\n        }\n        \n        if (allNull) {\n            this.rowKeys.remove(rowIndex);\n            this.rows.remove(rowIndex);\n        }\n        \n        // 2. check whether the column is now empty.\n        \n        \n    }\n\n    /**\n     * Removes an entire row from the table.\n     *\n     * @param rowIndex  the row index.\n     * \n     * @see #removeColumn(int)\n     */\n    public void removeRow(int rowIndex) {\n        this.rowKeys.remove(rowIndex);\n        this.rows.remove(rowIndex);\n    }\n\n    /**\n     * Removes an entire row from the table.\n     *\n     * @param rowKey  the row key (<code>null</code> not permitted).\n     * \n     * @throws UnknownKeyException if <code>rowKey</code> is not recognised.\n     * \n     * @see #removeColumn(Comparable)\n     */\n    public void removeRow(Comparable rowKey) {\n        int index = getRowIndex(rowKey);\n        removeRow(index);\n    }\n\n    /**\n     * Removes an entire column from the table.\n     *\n     * @param columnIndex  the column index.\n     * \n     * @see #removeRow(int)\n     */\n    public void removeColumn(int columnIndex) {\n        Comparable columnKey = getColumnKey(columnIndex);\n        removeColumn(columnKey);\n    }\n\n    /**\n     * Removes an entire column from the table.\n     *\n     * @param columnKey  the column key (<code>null</code> not permitted).\n     * \n     * @throws UnknownKeyException if <code>rowKey</code> is not recognised.\n     * \n     * @see #removeRow(Comparable)\n     */\n    public void removeColumn(Comparable columnKey) {\n        int index = getColumnIndex(columnKey);\n        if (index < 0) {\n            throw new UnknownKeyException(\"Column key (\" + columnKey \n                    + \") not recognised.\");\n        }\n        Iterator iterator = this.rows.iterator();\n        while (iterator.hasNext()) {\n            KeyedObjects rowData = (KeyedObjects) iterator.next();\n                rowData.removeValue(columnKey);\n        }\n        this.columnKeys.remove(columnKey);\n    }\n\n    /**\n     * Tests this object for equality with an arbitrary object.\n     *\n     * @param obj  the object to test (<code>null</code> permitted).\n     *\n     * @return A boolean.\n     */\n    public boolean equals(Object obj) {\n        if (obj == this) {\n            return true;\n        }\n        if (!(obj instanceof KeyedObjects2D)) {\n            return false;\n        }\n        \n        KeyedObjects2D that = (KeyedObjects2D) obj;\n        if (!getRowKeys().equals(that.getRowKeys())) {\n            return false;\n        }\n        if (!getColumnKeys().equals(that.getColumnKeys())) {\n            return false;\n        }\n        int rowCount = getRowCount();\n        if (rowCount != that.getRowCount()) {\n            return false;\n        }\n        int colCount = getColumnCount();\n        if (colCount != that.getColumnCount()) {\n            return false;\n        }\n        for (int r = 0; r < rowCount; r++) {\n            for (int c = 0; c < colCount; c++) {\n                Object v1 = getObject(r, c);\n                Object v2 = that.getObject(r, c);\n                if (v1 == null) {\n                    if (v2 != null) {\n                        return false;\n                    }\n                }\n                else {\n                    if (!v1.equals(v2)) {\n                        return false;\n                    }\n                }\n            }\n        }\n        return true;\n    }\n\n    /**\n     * Returns a hashcode for this object.\n     * \n     * @return A hashcode.\n     */\n    public int hashCode() {\n        int result;\n        result = this.rowKeys.hashCode();\n        result = 29 * result + this.columnKeys.hashCode();\n        result = 29 * result + this.rows.hashCode();\n        return result;\n    }\n\n    /**\n     * Returns a clone.\n     * \n     * @return A clone.\n     * \n     * @throws CloneNotSupportedException  this class will not throw this \n     *         exception, but subclasses (if any) might.\n     */\n    public Object clone() throws CloneNotSupportedException {\n        KeyedObjects2D clone = (KeyedObjects2D) super.clone();\n        clone.columnKeys = new java.util.ArrayList(this.columnKeys);\n        clone.rowKeys = new java.util.ArrayList(this.rowKeys);\n        clone.rows = new java.util.ArrayList(this.rows.size());\n        Iterator iterator = this.rows.iterator();\n        while (iterator.hasNext()) {\n            KeyedObjects row = (KeyedObjects) iterator.next();\n            clone.rows.add(row.clone());\n        }\n        return clone;\n    }\n\n}\n", "review": {"response": "{ \"bugs\": [\n\n  {\n    \"id\": 1,\n    \"description\": \"Inconsistent method naming: getRowKeys() vs getRowKeys()\",\n    \"severity\": \"Minor\"\n  },\n\n  {\n    \"id\": 2,\n    \"description\": \"Potential NullPointerException in getObject(int, int) method. If rowData or columnKey is null, it will throw NPE.\",\n    \"severity\": \"Major\"\n  },\n\n  {\n    \"id\": 3,\n    \"description\": \"Inconsistent exception handling: getObject(Comparable, Comparable) throws UnknownKeyException, but getObject(int, int) does not.\",\n    \"severity\": \"Minor\"\n  },\n\n  {\n    \"id\": 4,\n    \"description\": \"Lack of synchronization in getRowKeys() and getColumnKeys() methods. If the lists are modified concurrently, it may lead to inconsistent data.\",\n    \"severity\": \"Major\"\n  },\n\n  {\n    \"id\": 5,\n    \"description\": \"Missing comment for the serialVersionUID field.\",\n    \"severity\": \"Minor\"\n  },\n\n  {\n    \"id\": 6,\n    \"description\": \"The class implements Cloneable but does not provide a clone() method. It's better to provide a clone() method to ensure correct object cloning behavior.\",\n    \"severity\": \"Major\"\n  },\n\n  {\n    \"id\": 7,\n    \"description\": \"The class implements Serializable but does not provide a no-argument constructor. A no-argument constructor is required to deserialize the object.\",\n    \"severity\": \"Major\"\n  }\n\n] }"}}