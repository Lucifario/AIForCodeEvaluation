{"sample_id": "Chart_23", "model": "mistral-nemo", "code_context": "/* ===========================================================\n * JFreeChart : a free chart library for the Java(tm) platform\n * ===========================================================\n *\n * (C) Copyright 2000-2007, by Object Refinery Limited and Contributors.\n *\n * Project Info:  http://www.jfree.org/jfreechart/index.html\n *\n * This library is free software; you can redistribute it and/or modify it \n * under the terms of the GNU Lesser General Public License as published by \n * the Free Software Foundation; either version 2.1 of the License, or \n * (at your option) any later version.\n *\n * This library is distributed in the hope that it will be useful, but \n * WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY \n * or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public \n * License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public\n * License along with this library; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, \n * USA.  \n *\n * [Java is a trademark or registered trademark of Sun Microsystems, Inc. \n * in the United States and other countries.]\n *\n * ---------------------------\n * MinMaxCategoryRenderer.java\n * ---------------------------\n * (C) Copyright 2002-2007, by Object Refinery Limited.\n *\n * Original Author:  Tomer Peretz;\n * Contributor(s):   David Gilbert (for Object Refinery Limited);\n *                   Christian W. Zuckschwerdt;\n *                   Nicolas Brodu (for Astrium and EADS Corporate Research \n *                   Center);\n *\n * $Id: MinMaxCategoryRenderer.java,v 1.6.2.8 2007/06/01 15:12:15 mungady Exp $\n *\n * Changes:\n * --------\n * 29-May-2002 : Version 1 (TP);\n * 02-Oct-2002 : Fixed errors reported by Checkstyle (DG);\n * 24-Oct-2002 : Amendments for changes in CategoryDataset interface and \n *               CategoryToolTipGenerator interface (DG);\n * 05-Nov-2002 : Base dataset is now TableDataset not CategoryDataset (DG);\n * 17-Jan-2003 : Moved plot classes to a separate package (DG);\n * 10-Apr-2003 : Changed CategoryDataset to KeyedValues2DDataset in drawItem() \n *               method (DG);\n * 30-Jul-2003 : Modified entity constructor (CZ);\n * 08-Sep-2003 : Implemented Serializable (NB);\n * 29-Oct-2003 : Added workaround for font alignment in PDF output (DG);\n * 05-Nov-2004 : Modified drawItem() signature (DG);\n * 17-Nov-2005 : Added change events and argument checks (DG);\n * ------------- JFREECHART 1.0.x ---------------------------------------------\n * 02-Feb-2007 : Removed author tags all over JFreeChart sources (DG);\n * 09-Mar-2007 : Fixed problem with horizontal rendering (DG);\n * 21-Jun-2007 : Removed JCommon dependencies (DG);\n * 28-Sep-2007 : Added equals() method override (DG);\n * \n */\n\npackage org.jfree.chart.renderer.category;\n\nimport java.awt.BasicStroke;\nimport java.awt.Color;\nimport java.awt.Component;\nimport java.awt.Graphics;\nimport java.awt.Graphics2D;\nimport java.awt.Paint;\nimport java.awt.Shape;\nimport java.awt.Stroke;\nimport java.awt.geom.AffineTransform;\nimport java.awt.geom.Arc2D;\nimport java.awt.geom.GeneralPath;\nimport java.awt.geom.Line2D;\nimport java.awt.geom.Rectangle2D;\nimport java.io.IOException;\nimport java.io.ObjectInputStream;\nimport java.io.ObjectOutputStream;\n\nimport javax.swing.Icon;\n\nimport org.jfree.chart.axis.CategoryAxis;\nimport org.jfree.chart.axis.ValueAxis;\nimport org.jfree.chart.entity.EntityCollection;\nimport org.jfree.chart.event.RendererChangeEvent;\nimport org.jfree.chart.plot.CategoryPlot;\nimport org.jfree.chart.plot.PlotOrientation;\nimport org.jfree.chart.util.PaintUtilities;\nimport org.jfree.chart.util.SerialUtilities;\nimport org.jfree.data.category.CategoryDataset;\n\n/**\n * Renderer for drawing min max plot. This renderer draws all the series under \n * the same category in the same x position using <code>objectIcon</code> and \n * a line from the maximum value to the minimum value.\n * <p>\n * For use with the {@link org.jfree.chart.plot.CategoryPlot} class.\n */\npublic class MinMaxCategoryRenderer extends AbstractCategoryItemRenderer {\n\n    /** For serialization. */\n    private static final long serialVersionUID = 2935615937671064911L;\n    \n    /** A flag indicating whether or not lines are drawn between XY points. */\n    private boolean plotLines = false;\n\n    /** \n     * The paint of the line between the minimum value and the maximum value.\n     */\n    private transient Paint groupPaint = Color.black;\n\n    /** \n     * The stroke of the line between the minimum value and the maximum value.\n     */\n    private transient Stroke groupStroke = new BasicStroke(1.0f);\n\n    /** The icon used to indicate the minimum value.*/\n    private transient Icon minIcon = getIcon(new Arc2D.Double(-4, -4, 8, 8, 0,\n            360, Arc2D.OPEN), null, Color.black);\n\n    /** The icon used to indicate the maximum value.*/\n    private transient Icon maxIcon = getIcon(new Arc2D.Double(-4, -4, 8, 8, 0,\n            360, Arc2D.OPEN), null, Color.black);\n\n    /** The icon used to indicate the values.*/\n    private transient Icon objectIcon = getIcon(new Line2D.Double(-4, 0, 4, 0),\n            false, true);\n\n    /** The last category. */\n    private int lastCategory = -1;\n\n    /** The minimum. */\n    private double min;\n\n    /** The maximum. */\n    private double max;\n\n    /**\n     * Default constructor.\n     */\n    public MinMaxCategoryRenderer() {\n        super();\n    }\n\n    /**\n     * Gets whether or not lines are drawn between category points.\n     *\n     * @return boolean true if line will be drawn between sequenced categories,\n     *         otherwise false.\n     *         \n     * @see #setDrawLines(boolean)\n     */\n    public boolean isDrawLines() {\n        return this.plotLines;\n    }\n\n    /**\n     * Sets the flag that controls whether or not lines are drawn to connect\n     * the items within a series and sends a {@link RendererChangeEvent} to \n     * all registered listeners.\n     *\n     * @param draw  the new value of the flag.\n     * \n     * @see #isDrawLines()\n     */\n    public void setDrawLines(boolean draw) {\n        if (this.plotLines != draw) {\n            this.plotLines = draw;\n            this.notifyListeners(new RendererChangeEvent(this));\n        }\n        \n    }\n\n    /**\n     * Returns the paint used to draw the line between the minimum and maximum\n     * value items in each category.\n     *\n     * @return The paint (never <code>null</code>).\n     * \n     * @see #setGroupPaint(Paint)\n     */\n    public Paint getGroupPaint() {\n        return this.groupPaint;\n    }\n\n    /**\n     * Sets the paint used to draw the line between the minimum and maximum\n     * value items in each category and sends a {@link RendererChangeEvent} to\n     * all registered listeners.\n     *\n     * @param paint  the paint (<code>null</code> not permitted).\n     * \n     * @see #getGroupPaint()\n     */\n    public void setGroupPaint(Paint paint) {\n        if (paint == null) {\n            throw new IllegalArgumentException(\"Null 'paint' argument.\");\n        }\n        this.groupPaint = paint;\n        notifyListeners(new RendererChangeEvent(this));\n    }\n\n    /**\n     * Returns the stroke used to draw the line between the minimum and maximum\n     * value items in each category.\n     *\n     * @return The stroke (never <code>null</code>).\n     * \n     * @see #setGroupStroke(Stroke)\n     */\n    public Stroke getGroupStroke() {\n        return this.groupStroke;\n    }\n\n    /**\n     * Sets the stroke of the line between the minimum value and the maximum \n     * value and sends a {@link RendererChangeEvent} to all registered \n     * listeners.\n     *\n     * @param stroke the new stroke (<code>null</code> not permitted).\n     */\n    public void setGroupStroke(Stroke stroke) {\n        if (stroke == null) {\n            throw new IllegalArgumentException(\"Null 'stroke' argument.\");\n        }\n        this.groupStroke = stroke;\n        notifyListeners(new RendererChangeEvent(this));        \n    }\n\n    /**\n     * Returns the icon drawn for each data item.\n     *\n     * @return The icon (never <code>null</code>).\n     * \n     * @see #setObjectIcon(Icon)\n     */\n    public Icon getObjectIcon() {\n        return this.objectIcon;\n    }\n\n    /**\n     * Sets the icon drawn for each data item.\n     *\n     * @param icon  the icon.\n     * \n     * @see #getObjectIcon()\n     */\n    public void setObjectIcon(Icon icon) {\n        if (icon == null) {\n            throw new IllegalArgumentException(\"Null 'icon' argument.\");\n        }\n        this.objectIcon = icon;\n        notifyListeners(new RendererChangeEvent(this));\n    }\n\n    /**\n     * Returns the icon displayed for the maximum value data item within each\n     * category.\n     *\n     * @return The icon (never <code>null</code>).\n     * \n     * @see #setMaxIcon(Icon)\n     */\n    public Icon getMaxIcon() {\n        return this.maxIcon;\n    }\n\n    /**\n     * Sets the icon displayed for the maximum value data item within each\n     * category and sends a {@link RendererChangeEvent} to all registered\n     * listeners.\n     *\n     * @param icon  the icon (<code>null</code> not permitted).\n     * \n     * @see #getMaxIcon()\n     */\n    public void setMaxIcon(Icon icon) {\n        if (icon == null) {\n            throw new IllegalArgumentException(\"Null 'icon' argument.\");\n        }\n        this.maxIcon = icon;\n        notifyListeners(new RendererChangeEvent(this));\n    }\n\n    /**\n     * Returns the icon displayed for the minimum value data item within each\n     * category.\n     *\n     * @return The icon (never <code>null</code>).\n     * \n     * @see #setMinIcon(Icon)\n     */\n    public Icon getMinIcon() {\n        return this.minIcon;\n    }\n\n    /**\n     * Sets the icon displayed for the minimum value data item within each\n     * category and sends a {@link RendererChangeEvent} to all registered\n     * listeners.\n     *\n     * @param icon  the icon (<code>null</code> not permitted).\n     * \n     * @see #getMinIcon()\n     */\n    public void setMinIcon(Icon icon) {\n        if (icon == null) {\n            throw new IllegalArgumentException(\"Null 'icon' argument.\");\n        }\n        this.minIcon = icon;\n        notifyListeners(new RendererChangeEvent(this));\n    }\n\n    /**\n     * Draw a single data item.\n     *\n     * @param g2  the graphics device.\n     * @param state  the renderer state.\n     * @param dataArea  the area in which the data is drawn.\n     * @param plot  the plot.\n     * @param domainAxis  the domain axis.\n     * @param rangeAxis  the range axis.\n     * @param dataset  the dataset.\n     * @param row  the row index (zero-based).\n     * @param column  the column index (zero-based).\n     * @param pass  the pass index.\n     */\n    public void drawItem(Graphics2D g2, CategoryItemRendererState state,\n            Rectangle2D dataArea, CategoryPlot plot, CategoryAxis domainAxis,\n            ValueAxis rangeAxis, CategoryDataset dataset, int row, int column,\n            int pass) {\n\n        // first check the number we are plotting...\n        Number value = dataset.getValue(row, column);\n        if (value != null) {\n            // current data point...\n            double x1 = domainAxis.getCategoryMiddle(column, getColumnCount(), \n                    dataArea, plot.getDomainAxisEdge());\n            double y1 = rangeAxis.valueToJava2D(value.doubleValue(), dataArea, \n                    plot.getRangeAxisEdge());\n            g2.setPaint(getItemPaint(row, column));\n            g2.setStroke(getItemStroke(row, column));\n            Shape shape = null;\n            shape = new Rectangle2D.Double(x1 - 4, y1 - 4, 8.0, 8.0);\n            \n            PlotOrientation orient = plot.getOrientation();\n            if (orient == PlotOrientation.VERTICAL) {\n                this.objectIcon.paintIcon(null, g2, (int) x1, (int) y1);\n            }\n            else {\n                this.objectIcon.paintIcon(null, g2, (int) y1, (int) x1);                \n            }\n            \n            if (this.lastCategory == column) {\n                if (this.min > value.doubleValue()) {\n                    this.min = value.doubleValue();\n                }\n                if (this.max < value.doubleValue()) {\n                    this.max = value.doubleValue();\n                }\n                \n                // last series, so we are ready to draw the min and max\n                if (dataset.getRowCount() - 1 == row) {\n                    g2.setPaint(this.groupPaint);\n                    g2.setStroke(this.groupStroke);\n                    double minY = rangeAxis.valueToJava2D(this.min, dataArea, \n                            plot.getRangeAxisEdge());\n                    double maxY = rangeAxis.valueToJava2D(this.max, dataArea, \n                            plot.getRangeAxisEdge());\n                    \n                    if (orient == PlotOrientation.VERTICAL) {\n                        g2.draw(new Line2D.Double(x1, minY, x1, maxY));\n                        this.minIcon.paintIcon(null, g2, (int) x1, (int) minY);\n                        this.maxIcon.paintIcon(null, g2, (int) x1, (int) maxY);\n                    }\n                    else {\n                        g2.draw(new Line2D.Double(minY, x1, maxY, x1));\n                        this.minIcon.paintIcon(null, g2, (int) minY, (int) x1);\n                        this.maxIcon.paintIcon(null, g2, (int) maxY, (int) x1);                        \n                    }\n                }\n            }\n            else {  // reset the min and max\n                this.lastCategory = column;\n                this.min = value.doubleValue();\n                this.max = value.doubleValue();\n            }\n            \n            // connect to the previous point\n            if (this.plotLines) {\n                if (column != 0) {\n                    Number previousValue = dataset.getValue(row, column - 1);\n                    if (previousValue != null) {\n                        // previous data point...\n                        double previous = previousValue.doubleValue();\n                        double x0 = domainAxis.getCategoryMiddle(column - 1, \n                                getColumnCount(), dataArea,\n                                plot.getDomainAxisEdge());\n                        double y0 = rangeAxis.valueToJava2D(previous, dataArea,\n                                plot.getRangeAxisEdge());\n                        g2.setPaint(getItemPaint(row, column));\n                        g2.setStroke(getItemStroke(row, column));\n                        Line2D line;\n                        if (orient == PlotOrientation.VERTICAL) {\n                            line = new Line2D.Double(x0, y0, x1, y1);\n                        }\n                        else {\n                            line = new Line2D.Double(y0, x0, y1, x1);                            \n                        }\n                        g2.draw(line);\n                    }\n                }\n            }\n\n            // add an item entity, if this information is being collected\n            EntityCollection entities = state.getEntityCollection();\n            if (entities != null && shape != null) {\n                addItemEntity(entities, dataset, row, column, shape);\n            }\n        }\n    }\n    \n    /**\n     * Tests this instance for equality with an arbitrary object.  The icon fields\n     * are NOT included in the test, so this implementation is a little weak.\n     * \n     * @param obj  the object (<code>null</code> permitted).\n     * \n     * @return A boolean.\n     *\n     * @since 1.0.7\n     */\n\n    /**\n     * Returns an icon.\n     *\n     * @param shape  the shape.\n     * @param fillPaint  the fill paint.\n     * @param outlinePaint  the outline paint.\n     *\n     * @return The icon.\n     */\n    private Icon getIcon(Shape shape, final Paint fillPaint, \n                        final Paint outlinePaint) {\n\n      final int width = shape.getBounds().width;\n      final int height = shape.getBounds().height;\n      final GeneralPath path = new GeneralPath(shape);\n      return new Icon() {\n          public void paintIcon(Component c, Graphics g, int x, int y) {\n              Graphics2D g2 = (Graphics2D) g;\n              path.transform(AffineTransform.getTranslateInstance(x, y));\n              if (fillPaint != null) {\n                  g2.setPaint(fillPaint);\n                  g2.fill(path);\n              }\n              if (outlinePaint != null) {\n                  g2.setPaint(outlinePaint);\n                  g2.draw(path);\n              }\n              path.transform(AffineTransform.getTranslateInstance(-x, -y));\n        }\n\n        public int getIconWidth() {\n            return width;\n        }\n\n        public int getIconHeight() {\n            return height;\n        }\n\n      };\n    }\n\n    /**\n     * Returns an icon from a shape.\n     *\n     * @param shape  the shape.\n     * @param fill  the fill flag.\n     * @param outline  the outline flag.\n     *\n     * @return The icon.\n     */\n    private Icon getIcon(Shape shape, final boolean fill, \n            final boolean outline) {\n        final int width = shape.getBounds().width;\n        final int height = shape.getBounds().height;\n        final GeneralPath path = new GeneralPath(shape);\n        return new Icon() {\n            public void paintIcon(Component c, Graphics g, int x, int y) {\n                Graphics2D g2 = (Graphics2D) g;\n                path.transform(AffineTransform.getTranslateInstance(x, y));\n                if (fill) {\n                    g2.fill(path);\n                }\n                if (outline) {\n                    g2.draw(path);\n                }\n                path.transform(AffineTransform.getTranslateInstance(-x, -y));\n            }\n\n            public int getIconWidth() {\n                return width;\n            }\n\n            public int getIconHeight() {\n                return height;\n            }\n        };\n    }\n    \n    /**\n     * Provides serialization support.\n     *\n     * @param stream  the output stream.\n     *\n     * @throws IOException  if there is an I/O error.\n     */\n    private void writeObject(ObjectOutputStream stream) throws IOException {\n        stream.defaultWriteObject();\n        SerialUtilities.writeStroke(this.groupStroke, stream);\n        SerialUtilities.writePaint(this.groupPaint, stream);\n    }\n    \n    /**\n     * Provides serialization support.\n     *\n     * @param stream  the input stream.\n     *\n     * @throws IOException  if there is an I/O error.\n     * @throws ClassNotFoundException  if there is a classpath problem.\n     */\n    private void readObject(ObjectInputStream stream) \n        throws IOException, ClassNotFoundException {\n        stream.defaultReadObject();\n        this.groupStroke = SerialUtilities.readStroke(stream);\n        this.groupPaint = SerialUtilities.readPaint(stream);\n          \n        this.minIcon = getIcon(new Arc2D.Double(-4, -4, 8, 8, 0, 360, \n                Arc2D.OPEN), null, Color.black);\n        this.maxIcon = getIcon(new Arc2D.Double(-4, -4, 8, 8, 0, 360, \n                Arc2D.OPEN), null, Color.black);\n        this.objectIcon = getIcon(new Line2D.Double(-4, 0, 4, 0), false, true);\n    }\n    \n}\n", "review": {"response": "{\n  \"bugs\": [\n    {\n      \"description\": \"The MinMaxCategoryRenderer class uses a deprecated API for drawing icons. The getIcon method is not part of the Java 2D API and its behavior may vary across different Java implementations.\",\n      \"line\": \"private transient Icon minIcon = getIcon(new Arc2D.Double(-4, -4, 8, 8, 0, 360, Arc2D.OPEN), null, Color.black);\"\n    },\n    {\n      \"description\": \"The MinMaxCategoryRenderer class uses a deprecated API for drawing icons. The getIcon method is not part of the Java 2D API and its behavior may vary across different Java implementations.\",\n      \"line\": \"private transient Icon maxIcon = getIcon(new Arc2D.Double(-4, -4, 8, 8, 0, 360, Arc2D.OPEN), null, Color.black);\"\n    },\n    {\n      \"description\": \"The MinMaxCategoryRenderer class uses a deprecated API for drawing icons. The getIcon method is not part of the Java 2D API and its behavior may vary across different Java implementations.\",\n      \"line\": \"private transient Icon objectIcon = getIcon(new Line2D.Double(-4, 0, 4, 0), false, true);\"\n    },\n    {\n      \"description\": \"The MinMaxCategoryRenderer class does not seem to have a method for setting the group paint, group stroke, min icon, max icon, or object icon. This might make it difficult to customize the appearance of the renderer.\",\n      \"line\": \"private transient Paint groupPaint = Color.black;\"\n    },\n    {\n      \"description\": \"The MinMaxCategoryRenderer class does not seem to have a method for setting the group stroke, min icon, max icon, or object icon. This might make it difficult to customize the appearance of the renderer.\",\n      \"line\": \"private transient Stroke groupStroke = new BasicStroke(1.0f);\"\n    },\n    {\n      \"description\": \"The MinMaxCategoryRenderer class does not have a method for setting the minimum and maximum values. This might make it difficult to customize the appearance of the renderer.\",\n      \"line\": \"private double min;\"\n    },\n    {\n      \"description\": \"The MinMaxCategoryRenderer class does not have a method for setting the maximum value. This might make it difficult to customize the appearance of the renderer.\",\n      \"line\": \"private double max;\"\n    },\n    {\n      \"description\": \"The MinMaxCategoryRenderer class does not seem to have a method for setting the last category. This might make it difficult to customize the appearance of the renderer.\",\n      \"line\": \"private int lastCategory = -1;\"\n    }\n  ]\n}"}}