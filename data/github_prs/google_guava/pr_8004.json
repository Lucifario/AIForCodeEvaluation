{
  "id": 8004,
  "repository": "google/guava",
  "title": "Work around a bug in `central-publishing-maven-plugin` that causes us to skip publishing entirely for `guava-android`.",
  "body": "Work around a bug in `central-publishing-maven-plugin` that causes us to skip publishing entirely for `guava-android`.\n\nSee https://github.com/google/auto/issues/1965#issuecomment-3303077801 and https://github.com/google/gson/issues/2892#issuecomment-3272499409.\n\nRELNOTES=n/a\n",
  "state": "closed",
  "merged": true,
  "merged_at": "2025-09-17T18:25:52+00:00",
  "created_at": "2025-09-17T17:19:13+00:00",
  "updated_at": "2025-09-17T18:25:52+00:00",
  "author": "copybara-service[bot]",
  "reviewers": [],
  "base_sha": "4c4f855e85ee2aa5a0ee8c5a91de19a8153f3e0e",
  "head_sha": "119bd9bcce807e051e80fc2831eee928e43dabd9",
  "review_comments": [],
  "pr_comments": [],
  "files_changed": [
    {
      "filename": "android/guava-tests/pom.xml",
      "status": "modified",
      "additions": 14,
      "deletions": 3,
      "changes": 17,
      "patch": "@@ -97,9 +97,20 @@\n       <plugin>\n         <groupId>org.sonatype.central</groupId>\n         <artifactId>central-publishing-maven-plugin</artifactId>\n-        <configuration>\n-          <skipPublishing>true</skipPublishing>\n-        </configuration>\n+        <!--\n+        We set `phase` to `none` instead of setting `skipPublishing` to `true`.\n+        We do so because the plugin does all its work in the final subproject for which it will have an execution.\n+        And, if the final subproject says to skip publishing, it skips *all* publishing.\n+        (`guava-tests` is the final subproject for `guava-android` but not for `guava-jre`, which has `guava-gwt` after it.\n+        So we could use `skipPublishing` in `guava-jre` if we wanted.)\n+        See https://github.com/google/gson/issues/2892#issuecomment-3272499409\n+        -->\n+        <executions>\n+          <execution>\n+            <id>injected-central-publishing</id>\n+            <phase>none</phase>\n+          </execution>\n+        </executions>\n       </plugin>\n       <plugin>\n         <groupId>org.codehaus.mojo</groupId>"
    },
    {
      "filename": "guava-tests/pom.xml",
      "status": "modified",
      "additions": 14,
      "deletions": 3,
      "changes": 17,
      "patch": "@@ -97,9 +97,20 @@\n       <plugin>\n         <groupId>org.sonatype.central</groupId>\n         <artifactId>central-publishing-maven-plugin</artifactId>\n-        <configuration>\n-          <skipPublishing>true</skipPublishing>\n-        </configuration>\n+        <!--\n+        We set `phase` to `none` instead of setting `skipPublishing` to `true`.\n+        We do so because the plugin does all its work in the final subproject for which it will have an execution.\n+        And, if the final subproject says to skip publishing, it skips *all* publishing.\n+        (`guava-tests` is the final subproject for `guava-android` but not for `guava-jre`, which has `guava-gwt` after it.\n+        So we could use `skipPublishing` in `guava-jre` if we wanted.)\n+        See https://github.com/google/gson/issues/2892#issuecomment-3272499409\n+        -->\n+        <executions>\n+          <execution>\n+            <id>injected-central-publishing</id>\n+            <phase>none</phase>\n+          </execution>\n+        </executions>\n       </plugin>\n       <plugin>\n         <groupId>org.codehaus.mojo</groupId>"
    }
  ],
  "diff": "diff --git a/android/guava-tests/pom.xml b/android/guava-tests/pom.xml\nindex ad5835cb303a..9b0978b482f1 100644\n--- a/android/guava-tests/pom.xml\n+++ b/android/guava-tests/pom.xml\n@@ -97,9 +97,20 @@\n       <plugin>\n         <groupId>org.sonatype.central</groupId>\n         <artifactId>central-publishing-maven-plugin</artifactId>\n-        <configuration>\n-          <skipPublishing>true</skipPublishing>\n-        </configuration>\n+        <!--\n+        We set `phase` to `none` instead of setting `skipPublishing` to `true`.\n+        We do so because the plugin does all its work in the final subproject for which it will have an execution.\n+        And, if the final subproject says to skip publishing, it skips *all* publishing.\n+        (`guava-tests` is the final subproject for `guava-android` but not for `guava-jre`, which has `guava-gwt` after it.\n+        So we could use `skipPublishing` in `guava-jre` if we wanted.)\n+        See https://github.com/google/gson/issues/2892#issuecomment-3272499409\n+        -->\n+        <executions>\n+          <execution>\n+            <id>injected-central-publishing</id>\n+            <phase>none</phase>\n+          </execution>\n+        </executions>\n       </plugin>\n       <plugin>\n         <groupId>org.codehaus.mojo</groupId>\ndiff --git a/guava-tests/pom.xml b/guava-tests/pom.xml\nindex c56b0e48378b..48eaba15efe8 100644\n--- a/guava-tests/pom.xml\n+++ b/guava-tests/pom.xml\n@@ -97,9 +97,20 @@\n       <plugin>\n         <groupId>org.sonatype.central</groupId>\n         <artifactId>central-publishing-maven-plugin</artifactId>\n-        <configuration>\n-          <skipPublishing>true</skipPublishing>\n-        </configuration>\n+        <!--\n+        We set `phase` to `none` instead of setting `skipPublishing` to `true`.\n+        We do so because the plugin does all its work in the final subproject for which it will have an execution.\n+        And, if the final subproject says to skip publishing, it skips *all* publishing.\n+        (`guava-tests` is the final subproject for `guava-android` but not for `guava-jre`, which has `guava-gwt` after it.\n+        So we could use `skipPublishing` in `guava-jre` if we wanted.)\n+        See https://github.com/google/gson/issues/2892#issuecomment-3272499409\n+        -->\n+        <executions>\n+          <execution>\n+            <id>injected-central-publishing</id>\n+            <phase>none</phase>\n+          </execution>\n+        </executions>\n       </plugin>\n       <plugin>\n         <groupId>org.codehaus.mojo</groupId>\n",
  "additions": 28,
  "deletions": 6,
  "changed_files": 2,
  "url": "https://github.com/google/guava/pull/8004",
  "mined_at": "2025-10-25T13:01:39.687338"
}