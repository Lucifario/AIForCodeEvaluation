{
  "id": 8008,
  "repository": "google/guava",
  "title": "Update Javadoc with direct `FluentIterable.{index,uniqueIndex}` equivalents.",
  "body": "Update Javadoc with direct `FluentIterable.{index,uniqueIndex}` equivalents.\n\nAlso, update `FluentIterable` docs in `guava-android` to mention the `Stream`-related APIs that became part of `guava-android` in [Guava 33.4.0](https://github.com/google/guava/releases/tag/v33.4.0). This brings the docs closer to the corresponding `guava-jre` docs.\n\nFixes #3119\nFixes #8007\n\nRELNOTES=n/a\n",
  "state": "closed",
  "merged": true,
  "merged_at": "2025-09-19T20:39:32+00:00",
  "created_at": "2025-09-19T19:32:13+00:00",
  "updated_at": "2025-09-19T20:39:34+00:00",
  "author": "copybara-service[bot]",
  "reviewers": [],
  "base_sha": "e9ea5a982cad06ebd223ec6fdb5294eeb18654f6",
  "head_sha": "b94bd32f1923996261c0363b0a57283be391d87d",
  "review_comments": [],
  "pr_comments": [],
  "files_changed": [
    {
      "filename": "android/guava/src/com/google/common/collect/FluentIterable.java",
      "status": "modified",
      "additions": 25,
      "deletions": 28,
      "changes": 53,
      "patch": "@@ -77,8 +77,11 @@\n  *       noted in the method descriptions below.\n  *   <li>Streams include primitive-specialized variants such as {@code IntStream}, the use of which\n  *       is strongly recommended.\n- *   <li>Streams are standard Java, not requiring a third-party dependency (but do render your code\n- *       incompatible with Java 7 and earlier).\n+ *   <li>Streams are standard Java, not requiring a third-party dependency (but requiring <a\n+ *       href=\"https://developer.android.com/studio/write/java8-support#library-desugaring\">library\n+ *       desugaring</a> or <a\n+ *       href=\"https://developer.android.com/reference/java/util/stream/Stream\">API Level 24</a>\n+ *       under Android).\n  * </ul>\n  *\n  * <h3>Example</h3>\n@@ -137,8 +140,8 @@ private Iterable<E> getDelegate() {\n    * Returns a fluent iterable that wraps {@code iterable}, or {@code iterable} itself if it is\n    * already a {@code FluentIterable}.\n    *\n-   * <p><b>{@code Stream} equivalent:</b> {@code iterable.stream()} if {@code iterable} is a {@link\n-   * Collection}; {@code StreamSupport.stream(iterable.spliterator(), false)} otherwise.\n+   * <p><b>{@code Stream} equivalent:</b> {@link Collection#stream} if {@code iterable} is a {@link\n+   * Collection}; {@link Streams#stream(Iterable)} otherwise.\n    */\n   public static <E extends @Nullable Object> FluentIterable<E> from(Iterable<E> iterable) {\n     return (iterable instanceof FluentIterable)\n@@ -308,7 +311,7 @@ public Iterator<? extends T> get(int i) {\n   /**\n    * Returns a fluent iterable containing no elements.\n    *\n-   * <p><b>{@code Stream} equivalent:</b> {@code Stream.empty()}.\n+   * <p><b>{@code Stream} equivalent:</b> {@link Stream#empty}.\n    *\n    * @since 20.0\n    */\n@@ -345,7 +348,7 @@ public String toString() {\n   /**\n    * Returns the number of elements in this fluent iterable.\n    *\n-   * <p><b>{@code Stream} equivalent:</b> {@code stream.count()}.\n+   * <p><b>{@code Stream} equivalent:</b> {@link Stream#count}.\n    */\n   public final int size() {\n     return Iterables.size(getDelegate());\n@@ -614,8 +617,8 @@ public final boolean isEmpty() {\n    * Returns an {@code ImmutableList} containing all of the elements from this fluent iterable in\n    * proper sequence.\n    *\n-   * <p><b>{@code Stream} equivalent:</b> {@code ImmutableList.copyOf(stream.iterator())}, or pass\n-   * {@link ImmutableList#toImmutableList} to {@code stream.collect()}.\n+   * <p><b>{@code Stream} equivalent:</b> pass {@link ImmutableList#toImmutableList} to {@code\n+   * stream.collect()}.\n    *\n    * @throws NullPointerException if any element is {@code null}\n    * @since 14.0 (since 12.0 as {@code toImmutableList()}).\n@@ -630,9 +633,8 @@ public final boolean isEmpty() {\n    * FluentIterable} in the order specified by {@code comparator}. To produce an {@code\n    * ImmutableList} sorted by its natural ordering, use {@code toSortedList(Ordering.natural())}.\n    *\n-   * <p><b>{@code Stream} equivalent:</b> {@code\n-   * ImmutableList.copyOf(stream.sorted(comparator).iterator())}, or pass {@link\n-   * ImmutableList#toImmutableList} to {@code stream.sorted(comparator).collect()}.\n+   * <p><b>{@code Stream} equivalent:</b> pass {@link ImmutableList#toImmutableList} to {@code\n+   * stream.sorted(comparator).collect()}.\n    *\n    * @param comparator the function by which to sort list elements\n    * @throws NullPointerException if any element of this iterable is {@code null}\n@@ -647,8 +649,8 @@ public final boolean isEmpty() {\n    * Returns an {@code ImmutableSet} containing all of the elements from this fluent iterable with\n    * duplicates removed.\n    *\n-   * <p><b>{@code Stream} equivalent:</b> {@code ImmutableSet.copyOf(stream.iterator())}, or pass\n-   * {@link ImmutableSet#toImmutableSet} to {@code stream.collect()}.\n+   * <p><b>{@code Stream} equivalent:</b> pass {@link ImmutableSet#toImmutableSet} to {@code\n+   * stream.collect()}.\n    *\n    * @throws NullPointerException if any element is {@code null}\n    * @since 14.0 (since 12.0 as {@code toImmutableSet()}).\n@@ -664,9 +666,8 @@ public final boolean isEmpty() {\n    * {@code comparator.compare(x, y) == 0}) removed. To produce an {@code ImmutableSortedSet} sorted\n    * by its natural ordering, use {@code toSortedSet(Ordering.natural())}.\n    *\n-   * <p><b>{@code Stream} equivalent:</b> {@code ImmutableSortedSet.copyOf(comparator,\n-   * stream.iterator())}, or pass {@link ImmutableSortedSet#toImmutableSortedSet} to {@code\n-   * stream.collect()}.\n+   * <p><b>{@code Stream} equivalent:</b> pass {@link ImmutableSortedSet#toImmutableSortedSet} to\n+   * {@code stream.collect()}.\n    *\n    * @param comparator the function by which to sort set elements\n    * @throws NullPointerException if any element of this iterable is {@code null}\n@@ -680,8 +681,8 @@ public final boolean isEmpty() {\n   /**\n    * Returns an {@code ImmutableMultiset} containing all of the elements from this fluent iterable.\n    *\n-   * <p><b>{@code Stream} equivalent:</b> {@code ImmutableMultiset.copyOf(stream.iterator())}, or\n-   * pass {@link ImmutableMultiset#toImmutableMultiset} to {@code stream.collect()}.\n+   * <p><b>{@code Stream} equivalent:</b> pass {@link ImmutableMultiset#toImmutableMultiset} to\n+   * {@code stream.collect()}.\n    *\n    * @throws NullPointerException if any element is null\n    * @since 19.0\n@@ -700,9 +701,8 @@ public final boolean isEmpty() {\n    * {@code valueFunction} will be applied to more than one instance of that key and, if it is,\n    * which result will be mapped to that key in the returned map.\n    *\n-   * <p><b>{@code Stream} equivalent:</b> use {@code stream.collect(ImmutableMap.toImmutableMap(k ->\n-   * k, valueFunction))}. {@code ImmutableMap.copyOf(stream.collect(Collectors.toMap(k -> k,\n-   * valueFunction)))} behaves similarly, but may not preserve the order of entries.\n+   * <p><b>{@code Stream} equivalent:</b> {@code stream.collect(ImmutableMap.toImmutableMap(k -> k,\n+   * valueFunction))}.\n    *\n    * @throws NullPointerException if any element of this iterable is {@code null}, or if {@code\n    *     valueFunction} produces {@code null} for any key\n@@ -722,9 +722,8 @@ public final boolean isEmpty() {\n    * In the returned multimap, keys appear in the order they are first encountered, and the values\n    * corresponding to each key appear in the same order as they are encountered.\n    *\n-   * <p><b>{@code Stream} equivalent:</b> {@code stream.collect(Collectors.groupingBy(keyFunction))}\n-   * behaves similarly, but returns a mutable {@code Map<K, List<E>>} instead, and may not preserve\n-   * the order of entries.\n+   * <p><b>{@code Stream} equivalent:</b> {@code\n+   * stream.collect(ImmutableListMultimap.toImmutableListMultimap(keyFunction, v -> v))}.\n    *\n    * @param keyFunction the function used to produce the key for each value\n    * @throws NullPointerException if any element of this iterable is {@code null}, or if {@code\n@@ -754,10 +753,8 @@ public final boolean isEmpty() {\n    * <p>If your index may associate multiple values with each key, use {@link #index(Function)\n    * index}.\n    *\n-   * <p><b>{@code Stream} equivalent:</b> use {@code\n-   * stream.collect(ImmutableMap.toImmutableMap(keyFunction, v -> v))}. {@code\n-   * ImmutableMap.copyOf(stream.collect(Collectors.toMap(keyFunction, v -> v)))}, but be aware that\n-   * this may not preserve the order of entries.\n+   * <p><b>{@code Stream} equivalent:</b> {@code\n+   * stream.collect(ImmutableMap.toImmutableMap(keyFunction, v -> v))}.\n    *\n    * @param keyFunction the function used to produce the key for each value\n    * @return a map mapping the result of evaluating the function {@code keyFunction} on each value"
    },
    {
      "filename": "guava/src/com/google/common/collect/FluentIterable.java",
      "status": "modified",
      "additions": 2,
      "deletions": 3,
      "changes": 5,
      "patch": "@@ -715,9 +715,8 @@ public final boolean isEmpty() {\n    * In the returned multimap, keys appear in the order they are first encountered, and the values\n    * corresponding to each key appear in the same order as they are encountered.\n    *\n-   * <p><b>{@code Stream} equivalent:</b> {@code stream.collect(Collectors.groupingBy(keyFunction))}\n-   * behaves similarly, but returns a mutable {@code Map<K, List<E>>} instead, and may not preserve\n-   * the order of entries.\n+   * <p><b>{@code Stream} equivalent:</b> {@code\n+   * stream.collect(ImmutableListMultimap.toImmutableListMultimap(keyFunction, v -> v))}.\n    *\n    * @param keyFunction the function used to produce the key for each value\n    * @throws NullPointerException if any element of this iterable is {@code null}, or if {@code"
    }
  ],
  "diff": "diff --git a/android/guava/src/com/google/common/collect/FluentIterable.java b/android/guava/src/com/google/common/collect/FluentIterable.java\nindex bb299e5a5a1a..7324e14cd61b 100644\n--- a/android/guava/src/com/google/common/collect/FluentIterable.java\n+++ b/android/guava/src/com/google/common/collect/FluentIterable.java\n@@ -77,8 +77,11 @@\n  *       noted in the method descriptions below.\n  *   <li>Streams include primitive-specialized variants such as {@code IntStream}, the use of which\n  *       is strongly recommended.\n- *   <li>Streams are standard Java, not requiring a third-party dependency (but do render your code\n- *       incompatible with Java 7 and earlier).\n+ *   <li>Streams are standard Java, not requiring a third-party dependency (but requiring <a\n+ *       href=\"https://developer.android.com/studio/write/java8-support#library-desugaring\">library\n+ *       desugaring</a> or <a\n+ *       href=\"https://developer.android.com/reference/java/util/stream/Stream\">API Level 24</a>\n+ *       under Android).\n  * </ul>\n  *\n  * <h3>Example</h3>\n@@ -137,8 +140,8 @@ private Iterable<E> getDelegate() {\n    * Returns a fluent iterable that wraps {@code iterable}, or {@code iterable} itself if it is\n    * already a {@code FluentIterable}.\n    *\n-   * <p><b>{@code Stream} equivalent:</b> {@code iterable.stream()} if {@code iterable} is a {@link\n-   * Collection}; {@code StreamSupport.stream(iterable.spliterator(), false)} otherwise.\n+   * <p><b>{@code Stream} equivalent:</b> {@link Collection#stream} if {@code iterable} is a {@link\n+   * Collection}; {@link Streams#stream(Iterable)} otherwise.\n    */\n   public static <E extends @Nullable Object> FluentIterable<E> from(Iterable<E> iterable) {\n     return (iterable instanceof FluentIterable)\n@@ -308,7 +311,7 @@ public Iterator<? extends T> get(int i) {\n   /**\n    * Returns a fluent iterable containing no elements.\n    *\n-   * <p><b>{@code Stream} equivalent:</b> {@code Stream.empty()}.\n+   * <p><b>{@code Stream} equivalent:</b> {@link Stream#empty}.\n    *\n    * @since 20.0\n    */\n@@ -345,7 +348,7 @@ public String toString() {\n   /**\n    * Returns the number of elements in this fluent iterable.\n    *\n-   * <p><b>{@code Stream} equivalent:</b> {@code stream.count()}.\n+   * <p><b>{@code Stream} equivalent:</b> {@link Stream#count}.\n    */\n   public final int size() {\n     return Iterables.size(getDelegate());\n@@ -614,8 +617,8 @@ public final boolean isEmpty() {\n    * Returns an {@code ImmutableList} containing all of the elements from this fluent iterable in\n    * proper sequence.\n    *\n-   * <p><b>{@code Stream} equivalent:</b> {@code ImmutableList.copyOf(stream.iterator())}, or pass\n-   * {@link ImmutableList#toImmutableList} to {@code stream.collect()}.\n+   * <p><b>{@code Stream} equivalent:</b> pass {@link ImmutableList#toImmutableList} to {@code\n+   * stream.collect()}.\n    *\n    * @throws NullPointerException if any element is {@code null}\n    * @since 14.0 (since 12.0 as {@code toImmutableList()}).\n@@ -630,9 +633,8 @@ public final boolean isEmpty() {\n    * FluentIterable} in the order specified by {@code comparator}. To produce an {@code\n    * ImmutableList} sorted by its natural ordering, use {@code toSortedList(Ordering.natural())}.\n    *\n-   * <p><b>{@code Stream} equivalent:</b> {@code\n-   * ImmutableList.copyOf(stream.sorted(comparator).iterator())}, or pass {@link\n-   * ImmutableList#toImmutableList} to {@code stream.sorted(comparator).collect()}.\n+   * <p><b>{@code Stream} equivalent:</b> pass {@link ImmutableList#toImmutableList} to {@code\n+   * stream.sorted(comparator).collect()}.\n    *\n    * @param comparator the function by which to sort list elements\n    * @throws NullPointerException if any element of this iterable is {@code null}\n@@ -647,8 +649,8 @@ public final boolean isEmpty() {\n    * Returns an {@code ImmutableSet} containing all of the elements from this fluent iterable with\n    * duplicates removed.\n    *\n-   * <p><b>{@code Stream} equivalent:</b> {@code ImmutableSet.copyOf(stream.iterator())}, or pass\n-   * {@link ImmutableSet#toImmutableSet} to {@code stream.collect()}.\n+   * <p><b>{@code Stream} equivalent:</b> pass {@link ImmutableSet#toImmutableSet} to {@code\n+   * stream.collect()}.\n    *\n    * @throws NullPointerException if any element is {@code null}\n    * @since 14.0 (since 12.0 as {@code toImmutableSet()}).\n@@ -664,9 +666,8 @@ public final boolean isEmpty() {\n    * {@code comparator.compare(x, y) == 0}) removed. To produce an {@code ImmutableSortedSet} sorted\n    * by its natural ordering, use {@code toSortedSet(Ordering.natural())}.\n    *\n-   * <p><b>{@code Stream} equivalent:</b> {@code ImmutableSortedSet.copyOf(comparator,\n-   * stream.iterator())}, or pass {@link ImmutableSortedSet#toImmutableSortedSet} to {@code\n-   * stream.collect()}.\n+   * <p><b>{@code Stream} equivalent:</b> pass {@link ImmutableSortedSet#toImmutableSortedSet} to\n+   * {@code stream.collect()}.\n    *\n    * @param comparator the function by which to sort set elements\n    * @throws NullPointerException if any element of this iterable is {@code null}\n@@ -680,8 +681,8 @@ public final boolean isEmpty() {\n   /**\n    * Returns an {@code ImmutableMultiset} containing all of the elements from this fluent iterable.\n    *\n-   * <p><b>{@code Stream} equivalent:</b> {@code ImmutableMultiset.copyOf(stream.iterator())}, or\n-   * pass {@link ImmutableMultiset#toImmutableMultiset} to {@code stream.collect()}.\n+   * <p><b>{@code Stream} equivalent:</b> pass {@link ImmutableMultiset#toImmutableMultiset} to\n+   * {@code stream.collect()}.\n    *\n    * @throws NullPointerException if any element is null\n    * @since 19.0\n@@ -700,9 +701,8 @@ public final boolean isEmpty() {\n    * {@code valueFunction} will be applied to more than one instance of that key and, if it is,\n    * which result will be mapped to that key in the returned map.\n    *\n-   * <p><b>{@code Stream} equivalent:</b> use {@code stream.collect(ImmutableMap.toImmutableMap(k ->\n-   * k, valueFunction))}. {@code ImmutableMap.copyOf(stream.collect(Collectors.toMap(k -> k,\n-   * valueFunction)))} behaves similarly, but may not preserve the order of entries.\n+   * <p><b>{@code Stream} equivalent:</b> {@code stream.collect(ImmutableMap.toImmutableMap(k -> k,\n+   * valueFunction))}.\n    *\n    * @throws NullPointerException if any element of this iterable is {@code null}, or if {@code\n    *     valueFunction} produces {@code null} for any key\n@@ -722,9 +722,8 @@ public final boolean isEmpty() {\n    * In the returned multimap, keys appear in the order they are first encountered, and the values\n    * corresponding to each key appear in the same order as they are encountered.\n    *\n-   * <p><b>{@code Stream} equivalent:</b> {@code stream.collect(Collectors.groupingBy(keyFunction))}\n-   * behaves similarly, but returns a mutable {@code Map<K, List<E>>} instead, and may not preserve\n-   * the order of entries.\n+   * <p><b>{@code Stream} equivalent:</b> {@code\n+   * stream.collect(ImmutableListMultimap.toImmutableListMultimap(keyFunction, v -> v))}.\n    *\n    * @param keyFunction the function used to produce the key for each value\n    * @throws NullPointerException if any element of this iterable is {@code null}, or if {@code\n@@ -754,10 +753,8 @@ public final boolean isEmpty() {\n    * <p>If your index may associate multiple values with each key, use {@link #index(Function)\n    * index}.\n    *\n-   * <p><b>{@code Stream} equivalent:</b> use {@code\n-   * stream.collect(ImmutableMap.toImmutableMap(keyFunction, v -> v))}. {@code\n-   * ImmutableMap.copyOf(stream.collect(Collectors.toMap(keyFunction, v -> v)))}, but be aware that\n-   * this may not preserve the order of entries.\n+   * <p><b>{@code Stream} equivalent:</b> {@code\n+   * stream.collect(ImmutableMap.toImmutableMap(keyFunction, v -> v))}.\n    *\n    * @param keyFunction the function used to produce the key for each value\n    * @return a map mapping the result of evaluating the function {@code keyFunction} on each value\ndiff --git a/guava/src/com/google/common/collect/FluentIterable.java b/guava/src/com/google/common/collect/FluentIterable.java\nindex 0c7456363626..5761fc1360c6 100644\n--- a/guava/src/com/google/common/collect/FluentIterable.java\n+++ b/guava/src/com/google/common/collect/FluentIterable.java\n@@ -715,9 +715,8 @@ public final boolean isEmpty() {\n    * In the returned multimap, keys appear in the order they are first encountered, and the values\n    * corresponding to each key appear in the same order as they are encountered.\n    *\n-   * <p><b>{@code Stream} equivalent:</b> {@code stream.collect(Collectors.groupingBy(keyFunction))}\n-   * behaves similarly, but returns a mutable {@code Map<K, List<E>>} instead, and may not preserve\n-   * the order of entries.\n+   * <p><b>{@code Stream} equivalent:</b> {@code\n+   * stream.collect(ImmutableListMultimap.toImmutableListMultimap(keyFunction, v -> v))}.\n    *\n    * @param keyFunction the function used to produce the key for each value\n    * @throws NullPointerException if any element of this iterable is {@code null}, or if {@code\n",
  "additions": 27,
  "deletions": 31,
  "changed_files": 2,
  "url": "https://github.com/google/guava/pull/8008",
  "mined_at": "2025-10-25T13:01:20.396649"
}