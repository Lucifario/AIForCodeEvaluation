{
  "id": 137119,
  "repository": "elastic/elasticsearch",
  "title": "[9.2] fix test error (#137078)",
  "body": "Backports the following commits to 9.2:\n - fix test error (#137078)",
  "state": "closed",
  "merged": true,
  "merged_at": "2025-10-24T17:17:50+00:00",
  "created_at": "2025-10-24T16:14:35+00:00",
  "updated_at": "2025-10-24T17:18:13+00:00",
  "author": "drempapis",
  "reviewers": [],
  "base_sha": "f14175a6994edbce6bbac0a6b65cb51d7de046b3",
  "head_sha": "c582f4a8fdce304e39af7239fa1360151daa7c75",
  "review_comments": [],
  "pr_comments": [],
  "files_changed": [
    {
      "filename": "muted-tests.yml",
      "status": "modified",
      "additions": 0,
      "deletions": 3,
      "changes": 3,
      "patch": "@@ -408,9 +408,6 @@ tests:\n - class: org.elasticsearch.search.CCSDuelIT\n   method: testTermsAggsWithProfile\n   issue: https://github.com/elastic/elasticsearch/issues/132880\n-- class: org.elasticsearch.xpack.search.AsyncSearchErrorTraceIT\n-  method: testAsyncSearchFailingQueryErrorTraceDefault\n-  issue: https://github.com/elastic/elasticsearch/issues/133010\n - class: org.elasticsearch.xpack.security.authc.AuthenticationServiceTests\n   method: testInvalidToken\n   issue: https://github.com/elastic/elasticsearch/issues/133328"
    },
    {
      "filename": "x-pack/plugin/async-search/src/internalClusterTest/java/org/elasticsearch/xpack/search/AsyncSearchErrorTraceIT.java",
      "status": "modified",
      "additions": 6,
      "deletions": 6,
      "changes": 12,
      "patch": "@@ -76,7 +76,7 @@ public void testAsyncSearchFailingQueryErrorTraceDefault() throws Exception {\n         createAsyncRequest.addParameter(\"keep_on_completion\", \"true\");\n         createAsyncRequest.addParameter(\"wait_for_completion_timeout\", \"0ms\");\n         Map<String, Object> createAsyncResponseEntity = performRequestAndGetResponseEntity(createAsyncRequest);\n-        if (createAsyncResponseEntity.get(\"is_running\").equals(\"true\")) {\n+        if (Boolean.TRUE.equals(createAsyncResponseEntity.get(\"is_running\"))) {\n             String asyncExecutionId = (String) createAsyncResponseEntity.get(\"id\");\n             Request getAsyncRequest = new Request(\"GET\", \"/_async_search/\" + asyncExecutionId);\n             awaitAsyncRequestDoneRunning(getAsyncRequest);\n@@ -103,7 +103,7 @@ public void testAsyncSearchFailingQueryErrorTraceTrue() throws Exception {\n         createAsyncRequest.addParameter(\"keep_on_completion\", \"true\");\n         createAsyncRequest.addParameter(\"wait_for_completion_timeout\", \"0ms\");\n         Map<String, Object> createAsyncResponseEntity = performRequestAndGetResponseEntity(createAsyncRequest);\n-        if (createAsyncResponseEntity.get(\"is_running\").equals(\"true\")) {\n+        if (Boolean.TRUE.equals(createAsyncResponseEntity.get(\"is_running\"))) {\n             String asyncExecutionId = (String) createAsyncResponseEntity.get(\"id\");\n             Request getAsyncRequest = new Request(\"GET\", \"/_async_search/\" + asyncExecutionId);\n             getAsyncRequest.addParameter(\"error_trace\", \"true\");\n@@ -131,7 +131,7 @@ public void testAsyncSearchFailingQueryErrorTraceFalse() throws Exception {\n         createAsyncRequest.addParameter(\"keep_on_completion\", \"true\");\n         createAsyncRequest.addParameter(\"wait_for_completion_timeout\", \"0ms\");\n         Map<String, Object> createAsyncResponseEntity = performRequestAndGetResponseEntity(createAsyncRequest);\n-        if (createAsyncResponseEntity.get(\"is_running\").equals(\"true\")) {\n+        if (Boolean.TRUE.equals(createAsyncResponseEntity.get(\"is_running\"))) {\n             String asyncExecutionId = (String) createAsyncResponseEntity.get(\"id\");\n             Request getAsyncRequest = new Request(\"GET\", \"/_async_search/\" + asyncExecutionId);\n             getAsyncRequest.addParameter(\"error_trace\", \"false\");\n@@ -172,7 +172,7 @@ public void testDataNodeLogsStackTrace() throws Exception {\n         try (var mockLog = MockLog.capture(SearchService.class)) {\n             ErrorTraceHelper.addSeenLoggingExpectations(numShards, mockLog, errorTriggeringIndex);\n             Map<String, Object> createAsyncResponseEntity = performRequestAndGetResponseEntity(createAsyncRequest);\n-            if (createAsyncResponseEntity.get(\"is_running\").equals(\"true\")) {\n+            if (Boolean.TRUE.equals(createAsyncResponseEntity.get(\"is_running\"))) {\n                 String asyncExecutionId = (String) createAsyncResponseEntity.get(\"id\");\n                 Request getAsyncRequest = new Request(\"GET\", \"/_async_search/\" + asyncExecutionId);\n                 // Use the same value of error_trace as the search request\n@@ -206,7 +206,7 @@ public void testAsyncSearchFailingQueryErrorTraceFalseOnSubmitAndTrueOnGet() thr\n         createAsyncSearchRequest.addParameter(\"keep_on_completion\", \"true\");\n         createAsyncSearchRequest.addParameter(\"wait_for_completion_timeout\", \"0ms\");\n         Map<String, Object> createAsyncResponseEntity = performRequestAndGetResponseEntity(createAsyncSearchRequest);\n-        if (createAsyncResponseEntity.get(\"is_running\").equals(\"true\")) {\n+        if (Boolean.TRUE.equals(createAsyncResponseEntity.get(\"is_running\"))) {\n             String asyncExecutionId = (String) createAsyncResponseEntity.get(\"id\");\n             Request getAsyncRequest = new Request(\"GET\", \"/_async_search/\" + asyncExecutionId);\n             getAsyncRequest.addParameter(\"error_trace\", \"true\");\n@@ -234,7 +234,7 @@ public void testAsyncSearchFailingQueryErrorTraceTrueOnSubmitAndFalseOnGet() thr\n         createAsyncSearchRequest.addParameter(\"keep_on_completion\", \"true\");\n         createAsyncSearchRequest.addParameter(\"wait_for_completion_timeout\", \"0ms\");\n         Map<String, Object> createAsyncResponseEntity = performRequestAndGetResponseEntity(createAsyncSearchRequest);\n-        if (createAsyncResponseEntity.get(\"is_running\").equals(\"true\")) {\n+        if (Boolean.TRUE.equals(createAsyncResponseEntity.get(\"is_running\"))) {\n             String asyncExecutionId = (String) createAsyncResponseEntity.get(\"id\");\n             Request getAsyncRequest = new Request(\"GET\", \"/_async_search/\" + asyncExecutionId);\n             getAsyncRequest.addParameter(\"error_trace\", \"false\");"
    }
  ],
  "diff": "diff --git a/muted-tests.yml b/muted-tests.yml\nindex 7263fbf789d1d..a09196a08ee93 100644\n--- a/muted-tests.yml\n+++ b/muted-tests.yml\n@@ -408,9 +408,6 @@ tests:\n - class: org.elasticsearch.search.CCSDuelIT\n   method: testTermsAggsWithProfile\n   issue: https://github.com/elastic/elasticsearch/issues/132880\n-- class: org.elasticsearch.xpack.search.AsyncSearchErrorTraceIT\n-  method: testAsyncSearchFailingQueryErrorTraceDefault\n-  issue: https://github.com/elastic/elasticsearch/issues/133010\n - class: org.elasticsearch.xpack.security.authc.AuthenticationServiceTests\n   method: testInvalidToken\n   issue: https://github.com/elastic/elasticsearch/issues/133328\ndiff --git a/x-pack/plugin/async-search/src/internalClusterTest/java/org/elasticsearch/xpack/search/AsyncSearchErrorTraceIT.java b/x-pack/plugin/async-search/src/internalClusterTest/java/org/elasticsearch/xpack/search/AsyncSearchErrorTraceIT.java\nindex c132d38dd2792..83e7cf9e12096 100644\n--- a/x-pack/plugin/async-search/src/internalClusterTest/java/org/elasticsearch/xpack/search/AsyncSearchErrorTraceIT.java\n+++ b/x-pack/plugin/async-search/src/internalClusterTest/java/org/elasticsearch/xpack/search/AsyncSearchErrorTraceIT.java\n@@ -76,7 +76,7 @@ public void testAsyncSearchFailingQueryErrorTraceDefault() throws Exception {\n         createAsyncRequest.addParameter(\"keep_on_completion\", \"true\");\n         createAsyncRequest.addParameter(\"wait_for_completion_timeout\", \"0ms\");\n         Map<String, Object> createAsyncResponseEntity = performRequestAndGetResponseEntity(createAsyncRequest);\n-        if (createAsyncResponseEntity.get(\"is_running\").equals(\"true\")) {\n+        if (Boolean.TRUE.equals(createAsyncResponseEntity.get(\"is_running\"))) {\n             String asyncExecutionId = (String) createAsyncResponseEntity.get(\"id\");\n             Request getAsyncRequest = new Request(\"GET\", \"/_async_search/\" + asyncExecutionId);\n             awaitAsyncRequestDoneRunning(getAsyncRequest);\n@@ -103,7 +103,7 @@ public void testAsyncSearchFailingQueryErrorTraceTrue() throws Exception {\n         createAsyncRequest.addParameter(\"keep_on_completion\", \"true\");\n         createAsyncRequest.addParameter(\"wait_for_completion_timeout\", \"0ms\");\n         Map<String, Object> createAsyncResponseEntity = performRequestAndGetResponseEntity(createAsyncRequest);\n-        if (createAsyncResponseEntity.get(\"is_running\").equals(\"true\")) {\n+        if (Boolean.TRUE.equals(createAsyncResponseEntity.get(\"is_running\"))) {\n             String asyncExecutionId = (String) createAsyncResponseEntity.get(\"id\");\n             Request getAsyncRequest = new Request(\"GET\", \"/_async_search/\" + asyncExecutionId);\n             getAsyncRequest.addParameter(\"error_trace\", \"true\");\n@@ -131,7 +131,7 @@ public void testAsyncSearchFailingQueryErrorTraceFalse() throws Exception {\n         createAsyncRequest.addParameter(\"keep_on_completion\", \"true\");\n         createAsyncRequest.addParameter(\"wait_for_completion_timeout\", \"0ms\");\n         Map<String, Object> createAsyncResponseEntity = performRequestAndGetResponseEntity(createAsyncRequest);\n-        if (createAsyncResponseEntity.get(\"is_running\").equals(\"true\")) {\n+        if (Boolean.TRUE.equals(createAsyncResponseEntity.get(\"is_running\"))) {\n             String asyncExecutionId = (String) createAsyncResponseEntity.get(\"id\");\n             Request getAsyncRequest = new Request(\"GET\", \"/_async_search/\" + asyncExecutionId);\n             getAsyncRequest.addParameter(\"error_trace\", \"false\");\n@@ -172,7 +172,7 @@ public void testDataNodeLogsStackTrace() throws Exception {\n         try (var mockLog = MockLog.capture(SearchService.class)) {\n             ErrorTraceHelper.addSeenLoggingExpectations(numShards, mockLog, errorTriggeringIndex);\n             Map<String, Object> createAsyncResponseEntity = performRequestAndGetResponseEntity(createAsyncRequest);\n-            if (createAsyncResponseEntity.get(\"is_running\").equals(\"true\")) {\n+            if (Boolean.TRUE.equals(createAsyncResponseEntity.get(\"is_running\"))) {\n                 String asyncExecutionId = (String) createAsyncResponseEntity.get(\"id\");\n                 Request getAsyncRequest = new Request(\"GET\", \"/_async_search/\" + asyncExecutionId);\n                 // Use the same value of error_trace as the search request\n@@ -206,7 +206,7 @@ public void testAsyncSearchFailingQueryErrorTraceFalseOnSubmitAndTrueOnGet() thr\n         createAsyncSearchRequest.addParameter(\"keep_on_completion\", \"true\");\n         createAsyncSearchRequest.addParameter(\"wait_for_completion_timeout\", \"0ms\");\n         Map<String, Object> createAsyncResponseEntity = performRequestAndGetResponseEntity(createAsyncSearchRequest);\n-        if (createAsyncResponseEntity.get(\"is_running\").equals(\"true\")) {\n+        if (Boolean.TRUE.equals(createAsyncResponseEntity.get(\"is_running\"))) {\n             String asyncExecutionId = (String) createAsyncResponseEntity.get(\"id\");\n             Request getAsyncRequest = new Request(\"GET\", \"/_async_search/\" + asyncExecutionId);\n             getAsyncRequest.addParameter(\"error_trace\", \"true\");\n@@ -234,7 +234,7 @@ public void testAsyncSearchFailingQueryErrorTraceTrueOnSubmitAndFalseOnGet() thr\n         createAsyncSearchRequest.addParameter(\"keep_on_completion\", \"true\");\n         createAsyncSearchRequest.addParameter(\"wait_for_completion_timeout\", \"0ms\");\n         Map<String, Object> createAsyncResponseEntity = performRequestAndGetResponseEntity(createAsyncSearchRequest);\n-        if (createAsyncResponseEntity.get(\"is_running\").equals(\"true\")) {\n+        if (Boolean.TRUE.equals(createAsyncResponseEntity.get(\"is_running\"))) {\n             String asyncExecutionId = (String) createAsyncResponseEntity.get(\"id\");\n             Request getAsyncRequest = new Request(\"GET\", \"/_async_search/\" + asyncExecutionId);\n             getAsyncRequest.addParameter(\"error_trace\", \"false\");\n",
  "additions": 6,
  "deletions": 9,
  "changed_files": 2,
  "url": "https://github.com/elastic/elasticsearch/pull/137119",
  "mined_at": "2025-10-25T13:15:20.991998"
}